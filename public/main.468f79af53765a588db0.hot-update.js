/*! For license information please see main.468f79af53765a588db0.hot-update.js.LICENSE.txt */
"use strict";self.webpackHotUpdatefloema("main",{"./app/components/Canvas/collections/index.js":(t,s,e)=>{e.r(s),e.d(s,{default:()=>d});var i=e("./node_modules/ogl/src/core/Transform.js"),l=e("./node_modules/ogl/src/extras/Plane.js"),r=e("./node_modules/gsap/index.js"),o=e("./node_modules/prefix/index.js"),n=e.n(o),c=e("./node_modules/lodash/map.js"),a=e.n(c),h=e("./app/components/Canvas/collections/Media.js");const d=class{constructor({gl:t,scene:s,sizes:e,transition:l}){this.transition=l,this.id="collections",this.gl=t,this.scene=s,this.sizes=e,this.transformPrefix=n()("transform"),this.group=new i.Transform,this.galleryElement=document.querySelector(".collections__gallery"),this.galleryWrapperElement=document.querySelector(".collections__gallery__wrapper"),this.titlesElement=document.querySelector(".collections__titles"),this.collectionsElements=document.querySelectorAll(".collections__article"),this.collectionsElementsActive="collections__article--active",this.mediasElements=document.querySelectorAll(".collections__gallery__media"),this.scroll={current:0,target:0,lerp:.1},this.scroll={current:0,target:0,last:0,lerp:.1,velocity:1},this.createGeometry(),this.createGallery(),this.onResize({sizes:this.sizes}),this.group.setParent(this.scene),this.show()}createGeometry(){this.geometry=new l.Plane(this.gl)}createGallery(){this.medias=a()(this.mediasElements,((t,s)=>new h.default({element:t,geometry:this.geometry,gl:this.gl,index:s,scene:this.group,sizes:this.sizes})))}async show(){if(this.transition){const{src:t}=this.transition.mesh.program.uniforms.tMap.value.image,s=window.TEXTURES[t],e=this.medias.find((t=>t.texture===s)),i=-e.bounds.left-e.bounds.width/2+window.innerWidth/2;this.transition.animate({position:{x:0,y:0,z:0},rotation:e.mesh.rotation,scale:e.mesh.scale},(t=>{a()(this.medias,(t=>{t!==this.media&&t.show()})),this.media.opacity.multiplier=1,this.scroll.current=this.scroll.target=this.scroll.start=this.scroll.last=i}))}else a()(this.medias,(t=>t.show()))}hide(){a()(this.medias,(t=>t.hide()))}onResize(t){this.sizes=t.sizes,this.bounds=this.galleryWrapperElement.getBoundingClientRect(),this.scroll.last=this.scroll.target=0,a()(this.medias,(s=>s.onResize(t,this.scroll))),this.scroll.limit=this.bounds.width-this.medias[0].element.clientWidth}onTouchDown({x:t,y:s}){this.scroll.last=this.scroll.current}onTouchMove({x:t,y:s}){const e=t.start-t.end;this.scroll.target=this.scroll.last-e}onTouchUp({x:t,y:s}){}onWheel({pixelY:t}){this.scroll.target+=t}onChange(t){this.index=t;const s=parseInt(this.mediasElements[this.index].getAttribute("data-index"));a()(this.collectionsElements,((t,e)=>{e===s?t.classList.add(this.collectionsElementsActive):t.classList.remove(this.collectionsElementsActive)})),this.titlesElement.style[this.transformPrefix]=`translateY(-${25*s}%) translate(-50%, -50%) rotate(-90deg)`,this.media=this.medias[this.index]}update(){this.scroll.target=r.default.utils.clamp(-this.scroll.limit,0,this.scroll.target),this.scroll.current=r.default.utils.interpolate(this.scroll.current,this.scroll.target,this.scroll.lerp),this.galleryElement.style[this.transformPrefix]=`translateX(${this.scroll.current}px)`,this.scroll.last<this.scroll.current?this.scroll.direction="right":this.scroll.last>this.scroll.current&&(this.scroll.direction="left"),this.scroll.last=this.scroll.current;const t=Math.floor(Math.abs((this.scroll.current-this.medias[0].bounds.width/2)/this.scroll.limit)*(this.medias.length-1));this.index!==t&&this.onChange(t),a()(this.medias,((t,s)=>{t.update(this.scroll.current,this.index)}))}destroy(){this.scene.removeChild(this.group)}}}},(function(t){t.h=()=>"41fae258fe578d5b2d6f"}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S2UsT0FBT0UsT0FBUWpCLEtBQUtlLE9BQU9HLE1BRWxHbEIsS0FBS00sZUFBZTBFLE1BQU1oRixLQUFLRSxpQkFBb0IsY0FBYUYsS0FBS2UsT0FBT0MsYUFHeEVoQixLQUFLZSxPQUFPSSxLQUFPbkIsS0FBS2UsT0FBT0MsUUFDakNoQixLQUFLZSxPQUFPdUUsVUFBWSxRQUNmdEYsS0FBS2UsT0FBT0ksS0FBT25CLEtBQUtlLE9BQU9DLFVBQ3hDaEIsS0FBS2UsT0FBT3VFLFVBQVksUUFJMUJ0RixLQUFLZSxPQUFPSSxLQUFPbkIsS0FBS2UsT0FBT0MsUUFFL0IsTUFBTWUsRUFBUXdELEtBQUtDLE1BQU1ELEtBQUtFLEtBQUt6RixLQUFLZSxPQUFPQyxRQUFVaEIsS0FBSzRCLE9BQU8sR0FBR2lCLE9BQU9FLE1BQVEsR0FBSy9DLEtBQUtlLE9BQU9nRCxRQUFVL0QsS0FBSzRCLE9BQU84RCxPQUFTLElBR25JMUYsS0FBSytCLFFBQVVBLEdBQ2pCL0IsS0FBS3dFLFNBQVN6QyxHQUdoQkYsSUFBSTdCLEtBQUs0QixRQUFRLENBQUNlLEVBQU9aLEtBQ3ZCWSxFQUFNc0MsT0FBT2pGLEtBQUtlLE9BQU9DLFFBQVNoQixLQUFLK0IsTUFBTSxHQVFqRCxDQUtBNEQsT0FBQUEsR0FDRTNGLEtBQUtILE1BQU0rRixZQUFZNUYsS0FBS0ksTUFDOUIsa0JDbk5GeUYsRUFBb0JDLEVBQUksSUFBTSIsInNvdXJjZXMiOlsid2VicGFjazovL2Zsb2VtYS8uL2FwcC9jb21wb25lbnRzL0NhbnZhcy9jb2xsZWN0aW9ucy9pbmRleC5qcyIsIndlYnBhY2s6Ly9mbG9lbWEvd2VicGFjay9ydW50aW1lL2dldEZ1bGxIYXNoIl0sInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgUGxhbmUsIFRyYW5zZm9ybSB9IGZyb20gJ29nbCc7XG5pbXBvcnQgR1NBUCBmcm9tICdnc2FwJ1xuaW1wb3J0IFByZWZpeCBmcm9tICdwcmVmaXgnXG5cbmltcG9ydCBtYXAgZnJvbSAnbG9kYXNoL21hcCdcblxuaW1wb3J0IE1lZGlhIGZyb20gJy4vTWVkaWEnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoeyBnbCwgc2NlbmUsIHNpemVzLCB0cmFuc2l0aW9uIH0pIHtcbiAgICB0aGlzLnRyYW5zaXRpb24gPSB0cmFuc2l0aW9uO1xuICAgIHRoaXMuaWQgPSAnY29sbGVjdGlvbnMnO1xuICAgIHRoaXMuZ2wgPSBnbDtcbiAgICB0aGlzLnNjZW5lID0gc2NlbmVcbiAgICB0aGlzLnNpemVzID0gc2l6ZXM7XG5cbiAgICB0aGlzLnRyYW5zZm9ybVByZWZpeCA9IFByZWZpeCgndHJhbnNmb3JtJylcbiAgICB0aGlzLmdyb3VwID0gbmV3IFRyYW5zZm9ybSgpO1xuXG4gICAgdGhpcy5nYWxsZXJ5RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb2xsZWN0aW9uc19fZ2FsbGVyeScpXG4gICAgdGhpcy5nYWxsZXJ5V3JhcHBlckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29sbGVjdGlvbnNfX2dhbGxlcnlfX3dyYXBwZXInKVxuXG4gICAgdGhpcy50aXRsZXNFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbGxlY3Rpb25zX190aXRsZXMnKVxuXG4gICAgdGhpcy5jb2xsZWN0aW9uc0VsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbGxlY3Rpb25zX19hcnRpY2xlJylcbiAgICB0aGlzLmNvbGxlY3Rpb25zRWxlbWVudHNBY3RpdmUgPSAnY29sbGVjdGlvbnNfX2FydGljbGUtLWFjdGl2ZSdcblxuICAgIHRoaXMubWVkaWFzRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxuICAgICAgJy5jb2xsZWN0aW9uc19fZ2FsbGVyeV9fbWVkaWEnXG4gICAgKTtcblxuICAgIHRoaXMuc2Nyb2xsID0ge1xuICAgICAgY3VycmVudDogMCxcbiAgICAgIHRhcmdldDogMCxcbiAgICAgIGxlcnA6IDAuMVxuICAgIH1cblxuXG4gICAgdGhpcy5zY3JvbGwgPSB7XG4gICAgICBjdXJyZW50OiAwLFxuICAgICAgdGFyZ2V0OiAwLFxuICAgICAgbGFzdDogMCxcbiAgICAgIGxlcnA6IDAuMSxcbiAgICAgIHZlbG9jaXR5OiAxXG4gICAgfVxuXG4gICAgdGhpcy5jcmVhdGVHZW9tZXRyeSgpO1xuICAgIHRoaXMuY3JlYXRlR2FsbGVyeSgpO1xuXG4gICAgdGhpcy5vblJlc2l6ZSh7IHNpemVzOiB0aGlzLnNpemVzIH0pO1xuXG4gICAgdGhpcy5ncm91cC5zZXRQYXJlbnQodGhpcy5zY2VuZSk7XG5cbiAgICB0aGlzLnNob3coKVxuICAgIC8vIOWnkO+8jGNvbnN0cnVjdG9y5qC85byP5pivKHt9KXt944CC5LiN6KaB5b+Y6K6w5LqGXG5cbiAgfVxuXG4gIGNyZWF0ZUdlb21ldHJ5KCkge1xuICAgIHRoaXMuZ2VvbWV0cnkgPSBuZXcgUGxhbmUodGhpcy5nbClcbiAgfVxuXG4gIGNyZWF0ZUdhbGxlcnkoKSB7XG4gICAgLy8g5Lyg5YiwTWVkaWHph4zpnaJcbiAgICB0aGlzLm1lZGlhcyA9IG1hcCh0aGlzLm1lZGlhc0VsZW1lbnRzLCAoZWxlbWVudCwgaW5kZXgpID0+IHtcbiAgICAgIHJldHVybiBuZXcgTWVkaWEoe1xuICAgICAgICBlbGVtZW50LFxuICAgICAgICBnZW9tZXRyeTogdGhpcy5nZW9tZXRyeSxcbiAgICAgICAgZ2w6IHRoaXMuZ2wsXG4gICAgICAgIGluZGV4LFxuICAgICAgICBzY2VuZTogdGhpcy5ncm91cCxcbiAgICAgICAgc2l6ZXM6IHRoaXMuc2l6ZXNcbiAgICAgIH0pO1xuICAgIH0pXG4gIH1cblxuICAvLyBBbmltYXRpb25zXG4gIGFzeW5jIHNob3coKSB7XG4gICAgaWYgKHRoaXMudHJhbnNpdGlvbikge1xuICAgICAgY29uc3QgeyBzcmMgfSA9IHRoaXMudHJhbnNpdGlvbi5tZXNoLnByb2dyYW0udW5pZm9ybXMudE1hcC52YWx1ZS5pbWFnZTtcbiAgICAgIGNvbnN0IHRleHR1cmUgPSB3aW5kb3cuVEVYVFVSRVNbc3JjXTtcbiAgICAgIGNvbnN0IG1lZGlhID0gdGhpcy5tZWRpYXMuZmluZCgobWVkaWEpID0+IG1lZGlhLnRleHR1cmUgPT09IHRleHR1cmUpO1xuICAgICAgY29uc3Qgc2Nyb2xsID0gLW1lZGlhLmJvdW5kcy5sZWZ0IC0gbWVkaWEuYm91bmRzLndpZHRoIC8gMiArIHdpbmRvdy5pbm5lcldpZHRoIC8gMjtcblxuXG4gICAgICB0aGlzLnRyYW5zaXRpb24uYW5pbWF0ZSh7XG4gICAgICAgIHBvc2l0aW9uOiB7IHg6IDAsIHk6IDAsIHo6IDAgfSxcbiAgICAgICAgcm90YXRpb246IG1lZGlhLm1lc2gucm90YXRpb24sXG4gICAgICAgIHNjYWxlOiBtZWRpYS5tZXNoLnNjYWxlLFxuICAgICAgICAvLyDorqnov5Tlm57nmoTlm77niYdtYXRo5Y6f5p2l55qE5L2N572uXG5cbiAgICAgIH0sIF8gPT4ge1xuICAgICAgICBtYXAodGhpcy5tZWRpYXMsIG1lZGlhID0+IHtcbiAgICAgICAgICBpZiAobWVkaWEgIT09IHRoaXMubWVkaWEpIHtcbiAgICAgICAgICAgIG1lZGlhLnNob3coKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm1lZGlhLm9wYWNpdHkubXVsdGlwbGllciA9IDE7XG5cbiAgICAgICAgdGhpcy5zY3JvbGwuY3VycmVudCA9IHRoaXMuc2Nyb2xsLnRhcmdldCA9IHRoaXMuc2Nyb2xsLnN0YXJ0ID0gdGhpcy5zY3JvbGwubGFzdCA9IHNjcm9sbDtcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIG1hcCh0aGlzLm1lZGlhcywgbWVkaWEgPT4gbWVkaWEuc2hvdygpKVxuICAgIH1cbiAgfVxuICBoaWRlKCkge1xuICAgIG1hcCh0aGlzLm1lZGlhcywgKG1lZGlhKSA9PiBtZWRpYS5oaWRlKCkpXG4gIH1cblxuICAvLyBFdmVudHNcbiAgb25SZXNpemUoZXZlbnQpIHtcbiAgICB0aGlzLnNpemVzID0gZXZlbnQuc2l6ZXNcbiAgICAvLyDlsY/luZXnmoTlsLrlr7jvvIznu5l1cGRhdGXogIzkuI3mmK/nlLvluIPnmoRcbiAgICB0aGlzLmJvdW5kcyA9IHRoaXMuZ2FsbGVyeVdyYXBwZXJFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgLy8g6I635Y+W5YWD57Sg55qE5L2N572u5ZKM5bC65a+4XG5cbiAgICAvLyDorqHnrpflvZPliY3nlLvlu4rnmoTlrr3luqbljaDop4bnqpflj6PnmoTlrr3luqbnmoTlpJrlsJHnhLblkI7kuZjku6XlhbfkvZPnmoTlrr3luqYtLT7lsIblhYPntKDlnKjop4blj6PkuK3nmoTmr5TkvovovazmjaLkuLrlhbfkvZPnmoTlrp7pmYXlrr3luqbjgILlk43lupTlvI/luIPlsYBcbiAgICB0aGlzLnNjcm9sbC5sYXN0ID0gdGhpcy5zY3JvbGwudGFyZ2V0ID0gMFxuXG4gICAgbWFwKHRoaXMubWVkaWFzLCBtZWRpYSA9PiBtZWRpYS5vblJlc2l6ZShldmVudCwgdGhpcy5zY3JvbGwpKVxuICAgIHRoaXMuc2Nyb2xsLmxpbWl0ID0gdGhpcy5ib3VuZHMud2lkdGggLSB0aGlzLm1lZGlhc1swXS5lbGVtZW50LmNsaWVudFdpZHRoXG5cbiAgfVxuXG4gIG9uVG91Y2hEb3duKHsgeCwgeSB9KSB7XG4gICAgdGhpcy5zY3JvbGwubGFzdCA9IHRoaXMuc2Nyb2xsLmN1cnJlbnRcbiAgfVxuXG4gIG9uVG91Y2hNb3ZlKHsgeCwgeSB9KSB7XG4gICAgY29uc3QgZGlzdGFuY2UgPSB4LnN0YXJ0IC0geC5lbmRcblxuICAgIHRoaXMuc2Nyb2xsLnRhcmdldCA9IHRoaXMuc2Nyb2xsLmxhc3QgLSBkaXN0YW5jZVxuICAgIC8vIOWmguaenOm8oOagh+WSjOWbvueJh+eahOenu+WKqOebuOWPjeaWueWQke+8jOimgeeUqOWHj+WPt1xuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuc2Nyb2xsLnRhcmdldCwgZGlzdGFuY2UpXG4gICAgLy8g5aaC5p6c5Zu+54mH5LiN6IO956e75Yqo77yM55yL5LiL6byg5qCH6IO95LiN6IO956e75Yqo5pWw5o2u77yM5aaC5p6c6byg5qCH6IO956e75Yqo5pWw5o2u77yM6YKj5bCx5piv5rKh5pyJ5oqK6L+Z5Liq5YC857uZ5YiwbWVkaWHorqnlm77niYfnp7vliqhcbiAgfVxuXG4gIG9uVG91Y2hVcCh7IHgsIHkgfSkge1xuXG4gIH1cblxuICBvbldoZWVsKHsgcGl4ZWxZIH0pIHtcbiAgICAvLyDmjZXojrfmu5rliqjkuovku7bnmoTlg4/ntKDlgLzvvIznhLblkI7moLnmja7ov5nkupvlgLzmnaXmm7TmlrDpobXpnaLkuK3mn5DkupvlhYPntKDnmoTkvY3nva7miJbnirbmgIHvvIzlrp7njrDpobXpnaLnmoTmu5rliqjmiJbop4blm77nmoTlj5jljJZcbiAgICB0aGlzLnNjcm9sbC50YXJnZXQgKz0gcGl4ZWxZXG4gIH1cblxuICAvKipcbiAgICogQ2hhbmdlZOiBlOWKqOWKqOeUu+WbvueJh+aWh+Wtl+agh+mimFxuICAgKi9cbiAgb25DaGFuZ2UoaW5kZXgpIHtcbiAgICAvLyDku47lhbbku5blnLDmlrnmjqXlj5fntKLlvJUs6byg5qCH5ruR5Yqo77yM5bem5LiL6KeS5paH5a2X5YaF5a656Lef552A5Zu+54mH5Y+Y5YyWXG4gICAgdGhpcy5pbmRleCA9IGluZGV4XG5cbiAgICBjb25zdCBzZWxlY3RlZENvbGxlY3Rpb24gPSBwYXJzZUludCh0aGlzLm1lZGlhc0VsZW1lbnRzW3RoaXMuaW5kZXhdLmdldEF0dHJpYnV0ZSgnZGF0YS1pbmRleCcpKVxuXG4gICAgbWFwKHRoaXMuY29sbGVjdGlvbnNFbGVtZW50cywgKGVsZW1lbnQsIGVsZW1lbnRJbmRleCkgPT4ge1xuICAgICAgaWYgKGVsZW1lbnRJbmRleCA9PT0gc2VsZWN0ZWRDb2xsZWN0aW9uKSB7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLmNvbGxlY3Rpb25zRWxlbWVudHNBY3RpdmUpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5jb2xsZWN0aW9uc0VsZW1lbnRzQWN0aXZlKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLnRpdGxlc0VsZW1lbnQuc3R5bGVbdGhpcy50cmFuc2Zvcm1QcmVmaXhdID0gYHRyYW5zbGF0ZVkoLSR7MjUgKiBzZWxlY3RlZENvbGxlY3Rpb259JSkgdHJhbnNsYXRlKC01MCUsIC01MCUpIHJvdGF0ZSgtOTBkZWcpYFxuXG4gICAgdGhpcy5tZWRpYSA9IHRoaXMubWVkaWFzW3RoaXMuaW5kZXhdXG4gIH1cblxuICAvLyBVcGRhdGVcbiAgdXBkYXRlKCkge1xuICAgIHRoaXMuc2Nyb2xsLnRhcmdldCA9IEdTQVAudXRpbHMuY2xhbXAoLXRoaXMuc2Nyb2xsLmxpbWl0LCAwLCB0aGlzLnNjcm9sbC50YXJnZXQpXG4gICAgLy8g5rua5Yqo5rua6L2u6ZmQ5Yi2XG5cbiAgICB0aGlzLnNjcm9sbC5jdXJyZW50ID0gR1NBUC51dGlscy5pbnRlcnBvbGF0ZSh0aGlzLnNjcm9sbC5jdXJyZW50LCB0aGlzLnNjcm9sbC50YXJnZXQsIHRoaXMuc2Nyb2xsLmxlcnApXG5cbiAgICB0aGlzLmdhbGxlcnlFbGVtZW50LnN0eWxlW3RoaXMudHJhbnNmb3JtUHJlZml4XSA9IGB0cmFuc2xhdGVYKCR7dGhpcy5zY3JvbGwuY3VycmVudH1weClgXG4gICAgLy8g5bCG5Zu+54mH6ZO+5o6l55qE5a655ZmobWF0Y2jmu5rliqjnmoTlnZDmoIfpmo/nnYDlm77niYfkuIDotbfmu5rogIzkuI3mmK/lgZzlnKjljp/lnLBcblxuICAgIGlmICh0aGlzLnNjcm9sbC5sYXN0IDwgdGhpcy5zY3JvbGwuY3VycmVudCkge1xuICAgICAgdGhpcy5zY3JvbGwuZGlyZWN0aW9uID0gJ3JpZ2h0J1xuICAgIH0gZWxzZSBpZiAodGhpcy5zY3JvbGwubGFzdCA+IHRoaXMuc2Nyb2xsLmN1cnJlbnQpIHtcbiAgICAgIHRoaXMuc2Nyb2xsLmRpcmVjdGlvbiA9ICdsZWZ0J1xuICAgIH1cbiAgICAvLyDmo4DmtYvpvKDmoIfmu5rliqjmlrnlkJHvvIzlvZPliY3kvY3nva7lkozlhYjliY3kvY3nva7lgZrmr5TovoPjgIJcblxuICAgIHRoaXMuc2Nyb2xsLmxhc3QgPSB0aGlzLnNjcm9sbC5jdXJyZW50XG5cbiAgICBjb25zdCBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5hYnMoKHRoaXMuc2Nyb2xsLmN1cnJlbnQgLSB0aGlzLm1lZGlhc1swXS5ib3VuZHMud2lkdGggLyAyKSAvIHRoaXMuc2Nyb2xsLmxpbWl0KSAqICh0aGlzLm1lZGlhcy5sZW5ndGggLSAxKSk7XG4gICAgLy/lh4/ljrvkuIDljYrnmoTljaHniYflrr3luqYs5L2/5b6X5o+Q5YmNaGlnaGxpZ2h05Y2h54mHLOiAjOS4jeaYr+etieWIsOWNoeeJh3novbTkuK3lv4PmiY3mv4DmtLvlsLHmhaLkuoZcbiAgICAvLyBNYXRoLmZsb29yLOWPluaVtOaVsO+8jOa7muWKqOeJueWumui3neemu+WQjuehruWumuWbvueJh+WFg+e0oOWcqOaVsOe7hOS4reeahOe0ouW8lVxuICAgIGlmICh0aGlzLmluZGV4ICE9PSBpbmRleCkge1xuICAgICAgdGhpcy5vbkNoYW5nZShpbmRleClcbiAgICB9XG5cbiAgICBtYXAodGhpcy5tZWRpYXMsIChtZWRpYSwgaW5kZXgpID0+IHtcbiAgICAgIG1lZGlhLnVwZGF0ZSh0aGlzLnNjcm9sbC5jdXJyZW50LCB0aGlzLmluZGV4KVxuICAgICAgLy8gbWVkaWEubWVzaC5wb3NpdGlvbi55ICs9IE1hdGguY29zKChtZWRpYS5tZXNoLnBvc2l0aW9uLnggLyB0aGlzLnNpemVzLndpZHRoKSAqIE1hdGguUEkgKiAwLjEpICogNDAgLSA0MFxuXG4gICAgfSlcblxuICAgIC8vIOS8oOe7mW1lZGlh5paH5Lu2LOWwhuW9k+WJjeeahOm8oOagh+a7muWKqOS9jee9ruS8oOe7mW1lZGlhXG5cblxuICB9XG5cbiAgLyoqXG4gICAqIERlc3Ryb3lcbiAgICovXG4gIGRlc3Ryb3koKSB7XG4gICAgdGhpcy5zY2VuZS5yZW1vdmVDaGlsZCh0aGlzLmdyb3VwKVxuICB9XG5cbn0iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmggPSAoKSA9PiAoXCI0MWZhZTI1OGZlNTc4ZDViMmQ2ZlwiKSJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsImdsIiwic2NlbmUiLCJzaXplcyIsInRyYW5zaXRpb24iLCJ0aGlzIiwiaWQiLCJ0cmFuc2Zvcm1QcmVmaXgiLCJQcmVmaXgiLCJncm91cCIsIlRyYW5zZm9ybSIsImdhbGxlcnlFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZ2FsbGVyeVdyYXBwZXJFbGVtZW50IiwidGl0bGVzRWxlbWVudCIsImNvbGxlY3Rpb25zRWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY29sbGVjdGlvbnNFbGVtZW50c0FjdGl2ZSIsIm1lZGlhc0VsZW1lbnRzIiwic2Nyb2xsIiwiY3VycmVudCIsInRhcmdldCIsImxlcnAiLCJsYXN0IiwidmVsb2NpdHkiLCJjcmVhdGVHZW9tZXRyeSIsImNyZWF0ZUdhbGxlcnkiLCJvblJlc2l6ZSIsInNldFBhcmVudCIsInNob3ciLCJnZW9tZXRyeSIsIlBsYW5lIiwibWVkaWFzIiwibWFwIiwiZWxlbWVudCIsImluZGV4IiwiTWVkaWEiLCJzcmMiLCJtZXNoIiwicHJvZ3JhbSIsInVuaWZvcm1zIiwidE1hcCIsInZhbHVlIiwiaW1hZ2UiLCJ0ZXh0dXJlIiwid2luZG93IiwiVEVYVFVSRVMiLCJtZWRpYSIsImZpbmQiLCJib3VuZHMiLCJsZWZ0Iiwid2lkdGgiLCJpbm5lcldpZHRoIiwiYW5pbWF0ZSIsInBvc2l0aW9uIiwieCIsInkiLCJ6Iiwicm90YXRpb24iLCJzY2FsZSIsIl8iLCJvcGFjaXR5IiwibXVsdGlwbGllciIsInN0YXJ0IiwiaGlkZSIsImV2ZW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwibGltaXQiLCJjbGllbnRXaWR0aCIsIm9uVG91Y2hEb3duIiwib25Ub3VjaE1vdmUiLCJkaXN0YW5jZSIsImVuZCIsIm9uVG91Y2hVcCIsIm9uV2hlZWwiLCJwaXhlbFkiLCJvbkNoYW5nZSIsInNlbGVjdGVkQ29sbGVjdGlvbiIsInBhcnNlSW50IiwiZ2V0QXR0cmlidXRlIiwiZWxlbWVudEluZGV4IiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwic3R5bGUiLCJ1cGRhdGUiLCJHU0FQIiwidXRpbHMiLCJjbGFtcCIsImludGVycG9sYXRlIiwiZGlyZWN0aW9uIiwiTWF0aCIsImZsb29yIiwiYWJzIiwibGVuZ3RoIiwiZGVzdHJveSIsInJlbW92ZUNoaWxkIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsImgiXSwic291cmNlUm9vdCI6IiJ9