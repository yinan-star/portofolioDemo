/*! For license information please see main.cd0c93761e69c51ad4e6.hot-update.js.LICENSE.txt */
"use strict";self.webpackHotUpdatefloema("main",{"./app/components/Canvas/collections/index.js":(t,e,s)=>{s.r(e),s.d(e,{default:()=>d});var l=s("./node_modules/ogl/src/core/Transform.js"),i=s("./node_modules/ogl/src/extras/Plane.js"),o=s("./node_modules/gsap/index.js"),r=s("./node_modules/prefix/index.js"),n=s.n(r),c=s("./node_modules/lodash/map.js"),h=s.n(c),a=s("./app/components/Canvas/collections/Media.js");const d=class{constructor({gl:t,scene:e,sizes:s,transition:i}){this.transition=i,this.id="collections",this.gl=t,this.scene=e,this.sizes=s,this.transformPrefix=n()("transform"),this.group=new l.Transform,this.galleryElement=document.querySelector(".collections__gallery"),this.galleryWrapperElement=document.querySelector(".collections__gallery__wrapper"),this.titlesElement=document.querySelector(".collections__titles"),this.collectionsElements=document.querySelectorAll(".collections__article"),this.collectionsElementsActive="collections__article--active",this.mediasElements=document.querySelectorAll(".collections__gallery__media"),this.scroll={current:0,target:0,lerp:.1},this.scroll={current:0,target:0,last:0,lerp:.1,velocity:1},this.createGeometry(),this.createGallery(),this.onResize(),this.group.setParent(this.scene),this.show()}createGeometry(){this.geometry=new i.Plane(this.gl)}createGallery(){this.medias=h()(this.mediasElements,((t,e)=>new a.default({element:t,geometry:this.geometry,gl:this.gl,index:e,scene:this.group,sizes:this.sizes})))}show(){this.transition&&this.transition.animate(this.medias[0].mesh,(t=>{})),h()(this.medias,(t=>t.show()))}hide(){h()(this.medias,(t=>t.hide()))}onResize(t){this.sizes=t.sizes,this.bounds=this.galleryWrapperElement.getBoundingClientRect(),this.scroll.last=this.scroll.target=0,h()(this.medias,(e=>e.onResize(t,this.scroll))),this.scroll.limit=this.bounds.width-this.medias[0].element.clientWidth}onTouchDown({x:t,y:e}){this.scroll.last=this.scroll.current}onTouchMove({x:t,y:e}){const s=t.start-t.end;this.scroll.target=this.scroll.last-s}onTouchUp({x:t,y:e}){}onWheel({pixelY:t}){this.scroll.target+=t}onChange(t){this.index=t;const e=parseInt(this.mediasElements[this.index].getAttribute("data-index"));h()(this.collectionsElements,((t,s)=>{s===e?t.classList.add(this.collectionsElementsActive):t.classList.remove(this.collectionsElementsActive)})),this.titlesElement.style[this.transformPrefix]=`translateY(-${25*e}%) translate(-50%, -50%) rotate(-90deg)`}update(){this.scroll.target=o.default.utils.clamp(-this.scroll.limit,0,this.scroll.target),this.scroll.current=o.default.utils.interpolate(this.scroll.current,this.scroll.target,this.scroll.lerp),this.galleryElement.style[this.transformPrefix]=`translateX(${this.scroll.current}px)`,this.scroll.last<this.scroll.current?this.scroll.direction="right":this.scroll.last>this.scroll.current&&(this.scroll.direction="left"),this.scroll.last=this.scroll.current;const t=Math.floor(Math.abs(this.scroll.current/this.scroll.limit)*this.medias.length);this.index!==t&&this.onChange(t),h()(this.medias,((t,e)=>{t.update(this.scroll.current,this.index),t.mesh.position.y+=40*Math.cos(t.mesh.position.x/this.sizes.width*Math.PI*.1)-40}))}destroy(){this.scene.removeChild(this.group)}}}},(function(t){t.h=()=>"1aa61ffe9841e8123b32"}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQVMyQixLQUFLTSxHQUFLLElBQVksRUFBRSxHQU8vRyxDQUtBQyxPQUFBQSxHQUNJNUUsS0FBS0gsTUFBTWdGLFlBQVk3RSxLQUFLSSxNQUNoQyxrQkMzTEowRSxFQUFvQkMsRUFBSSxJQUFNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZmxvZW1hLy4vYXBwL2NvbXBvbmVudHMvQ2FudmFzL2NvbGxlY3Rpb25zL2luZGV4LmpzIiwid2VicGFjazovL2Zsb2VtYS93ZWJwYWNrL3J1bnRpbWUvZ2V0RnVsbEhhc2giXSwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgeyBQbGFuZSwgVHJhbnNmb3JtIH0gZnJvbSAnb2dsJztcbmltcG9ydCBHU0FQIGZyb20gJ2dzYXAnXG5pbXBvcnQgUHJlZml4IGZyb20gJ3ByZWZpeCdcblxuaW1wb3J0IG1hcCBmcm9tICdsb2Rhc2gvbWFwJ1xuXG5pbXBvcnQgTWVkaWEgZnJvbSAnLi9NZWRpYSdcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKHsgZ2wsIHNjZW5lLCBzaXplcyx0cmFuc2l0aW9uIH0pIHtcbiAgICAgICAgdGhpcy50cmFuc2l0aW9uID0gdHJhbnNpdGlvbjtcbiAgICAgICAgdGhpcy5pZCA9ICdjb2xsZWN0aW9ucyc7XG4gICAgICAgIHRoaXMuZ2wgPSBnbDtcbiAgICAgICAgdGhpcy5zY2VuZSA9IHNjZW5lXG4gICAgICAgIHRoaXMuc2l6ZXMgPSBzaXplcztcblxuICAgICAgICB0aGlzLnRyYW5zZm9ybVByZWZpeCA9IFByZWZpeCgndHJhbnNmb3JtJylcbiAgICAgICAgdGhpcy5ncm91cCA9IG5ldyBUcmFuc2Zvcm0oKTtcblxuICAgICAgICB0aGlzLmdhbGxlcnlFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbGxlY3Rpb25zX19nYWxsZXJ5JylcbiAgICAgICAgdGhpcy5nYWxsZXJ5V3JhcHBlckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29sbGVjdGlvbnNfX2dhbGxlcnlfX3dyYXBwZXInKVxuXG4gICAgICAgIHRoaXMudGl0bGVzRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb2xsZWN0aW9uc19fdGl0bGVzJylcblxuICAgICAgICB0aGlzLmNvbGxlY3Rpb25zRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29sbGVjdGlvbnNfX2FydGljbGUnKVxuICAgICAgICB0aGlzLmNvbGxlY3Rpb25zRWxlbWVudHNBY3RpdmUgPSAnY29sbGVjdGlvbnNfX2FydGljbGUtLWFjdGl2ZSdcblxuICAgICAgICB0aGlzLm1lZGlhc0VsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcbiAgICAgICAgICAgICcuY29sbGVjdGlvbnNfX2dhbGxlcnlfX21lZGlhJ1xuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuc2Nyb2xsID0ge1xuICAgICAgICAgICAgY3VycmVudDogMCxcbiAgICAgICAgICAgIHRhcmdldDogMCxcbiAgICAgICAgICAgIGxlcnA6IDAuMVxuICAgICAgICB9XG5cblxuICAgICAgICB0aGlzLnNjcm9sbCA9IHtcbiAgICAgICAgICAgIGN1cnJlbnQ6IDAsXG4gICAgICAgICAgICB0YXJnZXQ6IDAsXG4gICAgICAgICAgICBsYXN0OiAwLFxuICAgICAgICAgICAgbGVycDogMC4xLFxuICAgICAgICAgICAgdmVsb2NpdHk6IDFcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY3JlYXRlR2VvbWV0cnkoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVHYWxsZXJ5KCk7XG5cbiAgICAgICAgdGhpcy5vblJlc2l6ZSgpXG5cbiAgICAgICAgdGhpcy5ncm91cC5zZXRQYXJlbnQodGhpcy5zY2VuZSk7XG5cbiAgICAgICAgdGhpcy5zaG93KClcbiAgICAgICAgLy8g5aeQ77yMY29uc3RydWN0b3LmoLzlvI/mmK8oe30pe33jgILkuI3opoHlv5jorrDkuoZcblxuICAgIH1cblxuICAgIGNyZWF0ZUdlb21ldHJ5KCkge1xuICAgICAgICB0aGlzLmdlb21ldHJ5ID0gbmV3IFBsYW5lKHRoaXMuZ2wpXG4gICAgfVxuXG4gICAgY3JlYXRlR2FsbGVyeSgpIHtcbiAgICAgICAgLy8g5Lyg5YiwTWVkaWHph4zpnaJcbiAgICAgICAgdGhpcy5tZWRpYXMgPSBtYXAodGhpcy5tZWRpYXNFbGVtZW50cywgKGVsZW1lbnQsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE1lZGlhKHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LFxuICAgICAgICAgICAgICAgIGdlb21ldHJ5OiB0aGlzLmdlb21ldHJ5LFxuICAgICAgICAgICAgICAgIGdsOiB0aGlzLmdsLFxuICAgICAgICAgICAgICAgIGluZGV4LFxuICAgICAgICAgICAgICAgIHNjZW5lOiB0aGlzLmdyb3VwLFxuICAgICAgICAgICAgICAgIHNpemVzOiB0aGlzLnNpemVzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBBbmltYXRpb25zXG4gICAgc2hvdygpIHtcbiAgICAgICAgaWYodGhpcy50cmFuc2l0aW9uKXtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvbi5hbmltYXRlKHRoaXMubWVkaWFzWzBdLm1lc2gsIF8gPT57XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIG1hcCh0aGlzLm1lZGlhcywgbWVkaWEgPT4gbWVkaWEuc2hvdygpKVxuICAgIH1cbiAgICBoaWRlKCkge1xuICAgICAgICBtYXAodGhpcy5tZWRpYXMsIG1lZGlhID0+IG1lZGlhLmhpZGUoKSlcbiAgICB9XG5cbiAgICAvLyBFdmVudHNcbiAgICBvblJlc2l6ZShldmVudCkge1xuICAgICAgICB0aGlzLnNpemVzID0gZXZlbnQuc2l6ZXNcbiAgICAgICAgLy8g5bGP5bmV55qE5bC65a+477yM57uZdXBkYXRl6ICM5LiN5piv55S75biD55qEXG4gICAgICAgIHRoaXMuYm91bmRzID0gdGhpcy5nYWxsZXJ5V3JhcHBlckVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgICAgLy8g6I635Y+W5YWD57Sg55qE5L2N572u5ZKM5bC65a+4XG5cbiAgICAgICAgLy8g6K6h566X5b2T5YmN55S75buK55qE5a695bqm5Y2g6KeG56qX5Y+j55qE5a695bqm55qE5aSa5bCR54S25ZCO5LmY5Lul5YW35L2T55qE5a695bqmLS0+5bCG5YWD57Sg5Zyo6KeG5Y+j5Lit55qE5q+U5L6L6L2s5o2i5Li65YW35L2T55qE5a6e6ZmF5a695bqm44CC5ZON5bqU5byP5biD5bGAXG4gICAgICAgIHRoaXMuc2Nyb2xsLmxhc3QgPSB0aGlzLnNjcm9sbC50YXJnZXQgPSAwXG5cbiAgICAgICAgbWFwKHRoaXMubWVkaWFzLCBtZWRpYSA9PiBtZWRpYS5vblJlc2l6ZShldmVudCwgdGhpcy5zY3JvbGwpKVxuICAgICAgICB0aGlzLnNjcm9sbC5saW1pdCA9IHRoaXMuYm91bmRzLndpZHRoIC0gdGhpcy5tZWRpYXNbMF0uZWxlbWVudC5jbGllbnRXaWR0aFxuXG4gICAgfVxuXG4gICAgb25Ub3VjaERvd24oeyB4LCB5IH0pIHtcbiAgICAgICAgdGhpcy5zY3JvbGwubGFzdCA9IHRoaXMuc2Nyb2xsLmN1cnJlbnRcbiAgICB9XG5cbiAgICBvblRvdWNoTW92ZSh7IHgsIHkgfSkge1xuICAgICAgICBjb25zdCBkaXN0YW5jZSA9IHguc3RhcnQgLSB4LmVuZFxuXG4gICAgICAgIHRoaXMuc2Nyb2xsLnRhcmdldCA9IHRoaXMuc2Nyb2xsLmxhc3QgLSBkaXN0YW5jZVxuICAgICAgICAvLyDlpoLmnpzpvKDmoIflkozlm77niYfnmoTnp7vliqjnm7jlj43mlrnlkJHvvIzopoHnlKjlh4/lj7dcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5zY3JvbGwudGFyZ2V0LCBkaXN0YW5jZSlcbiAgICAgICAgLy8g5aaC5p6c5Zu+54mH5LiN6IO956e75Yqo77yM55yL5LiL6byg5qCH6IO95LiN6IO956e75Yqo5pWw5o2u77yM5aaC5p6c6byg5qCH6IO956e75Yqo5pWw5o2u77yM6YKj5bCx5piv5rKh5pyJ5oqK6L+Z5Liq5YC857uZ5YiwbWVkaWHorqnlm77niYfnp7vliqhcbiAgICB9XG5cbiAgICBvblRvdWNoVXAoeyB4LCB5IH0pIHtcblxuICAgIH1cblxuICAgIG9uV2hlZWwoeyBwaXhlbFkgfSkge1xuICAgICAgICAvLyDmjZXojrfmu5rliqjkuovku7bnmoTlg4/ntKDlgLzvvIznhLblkI7moLnmja7ov5nkupvlgLzmnaXmm7TmlrDpobXpnaLkuK3mn5DkupvlhYPntKDnmoTkvY3nva7miJbnirbmgIHvvIzlrp7njrDpobXpnaLnmoTmu5rliqjmiJbop4blm77nmoTlj5jljJZcbiAgICAgICAgdGhpcy5zY3JvbGwudGFyZ2V0ICs9IHBpeGVsWVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoYW5nZWTogZTliqjliqjnlLvlm77niYfmloflrZfmoIfpophcbiAgICAgKi9cbiAgICBvbkNoYW5nZSAoaW5kZXgpe1xuICAgICAgICAvLyDku47lhbbku5blnLDmlrnmjqXlj5fntKLlvJUs6byg5qCH5ruR5Yqo77yM5bem5LiL6KeS5paH5a2X5YaF5a656Lef552A5Zu+54mH5Y+Y5YyWXG4gICAgICAgIHRoaXMuaW5kZXggPWluZGV4XG5cbiAgICAgICAgY29uc3Qgc2VsZWN0ZWRDb2xsZWN0aW9uID0gcGFyc2VJbnQodGhpcy5tZWRpYXNFbGVtZW50c1t0aGlzLmluZGV4XS5nZXRBdHRyaWJ1dGUoJ2RhdGEtaW5kZXgnKSlcblxuICAgICAgICBtYXAodGhpcy5jb2xsZWN0aW9uc0VsZW1lbnRzLCAoZWxlbWVudCxlbGVtZW50SW5kZXgpID0+IHtcbiAgICAgICAgICAgIGlmKGVsZW1lbnRJbmRleCA9PT0gc2VsZWN0ZWRDb2xsZWN0aW9uKXtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5jb2xsZWN0aW9uc0VsZW1lbnRzQWN0aXZlKVxuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuY29sbGVjdGlvbnNFbGVtZW50c0FjdGl2ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICB0aGlzLnRpdGxlc0VsZW1lbnQuc3R5bGVbdGhpcy50cmFuc2Zvcm1QcmVmaXhdID0gYHRyYW5zbGF0ZVkoLSR7MjUgKiBzZWxlY3RlZENvbGxlY3Rpb259JSkgdHJhbnNsYXRlKC01MCUsIC01MCUpIHJvdGF0ZSgtOTBkZWcpYFxuICAgIH1cblxuICAgIC8vIFVwZGF0ZVxuICAgIHVwZGF0ZSgpIHtcbiAgICAgICAgdGhpcy5zY3JvbGwudGFyZ2V0ID0gR1NBUC51dGlscy5jbGFtcCggLXRoaXMuc2Nyb2xsLmxpbWl0LCAwLCB0aGlzLnNjcm9sbC50YXJnZXQpXG4gICAgICAgIC8vIOa7muWKqOa7mui9rumZkOWItlxuXG4gICAgICAgIHRoaXMuc2Nyb2xsLmN1cnJlbnQgPSBHU0FQLnV0aWxzLmludGVycG9sYXRlKHRoaXMuc2Nyb2xsLmN1cnJlbnQsIHRoaXMuc2Nyb2xsLnRhcmdldCwgdGhpcy5zY3JvbGwubGVycClcblxuICAgICAgICB0aGlzLmdhbGxlcnlFbGVtZW50LnN0eWxlW3RoaXMudHJhbnNmb3JtUHJlZml4XSA9IGB0cmFuc2xhdGVYKCR7dGhpcy5zY3JvbGwuY3VycmVudH1weClgXG4gICAgICAgIC8vIOWwhuWbvueJh+mTvuaOpeeahOWuueWZqG1hdGNo5rua5Yqo55qE5Z2Q5qCH6ZqP552A5Zu+54mH5LiA6LW35rua6ICM5LiN5piv5YGc5Zyo5Y6f5ZywXG5cbiAgICAgICAgaWYgKHRoaXMuc2Nyb2xsLmxhc3QgPCB0aGlzLnNjcm9sbC5jdXJyZW50KSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbC5kaXJlY3Rpb24gPSAncmlnaHQnXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zY3JvbGwubGFzdCA+IHRoaXMuc2Nyb2xsLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsLmRpcmVjdGlvbiA9ICdsZWZ0J1xuICAgICAgICB9XG4gICAgICAgIC8vIOajgOa1i+m8oOagh+a7muWKqOaWueWQke+8jOW9k+WJjeS9jee9ruWSjOWFiOWJjeS9jee9ruWBmuavlOi+g+OAglxuXG4gICAgICAgIHRoaXMuc2Nyb2xsLmxhc3QgPSB0aGlzLnNjcm9sbC5jdXJyZW50XG5cbiAgICAgICAgY29uc3QgaW5kZXggPU1hdGguZmxvb3IoTWF0aC5hYnModGhpcy5zY3JvbGwuY3VycmVudCAvIHRoaXMuc2Nyb2xsLmxpbWl0KSAqIHRoaXMubWVkaWFzLmxlbmd0aClcbiAgICAgICAgLy8gTWF0aC5mbG9vcizlj5bmlbTmlbDvvIzmu5rliqjnibnlrprot53nprvlkI7noa7lrprlm77niYflhYPntKDlnKjmlbDnu4TkuK3nmoTntKLlvJVcbiAgICAgICAgaWYodGhpcy5pbmRleCAhPT0gaW5kZXgpe1xuICAgICAgICAgICAgdGhpcy5vbkNoYW5nZShpbmRleCkgIFxuICAgICAgICB9XG5cbiAgICAgICAgbWFwKHRoaXMubWVkaWFzLCAobWVkaWEsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBtZWRpYS51cGRhdGUodGhpcy5zY3JvbGwuY3VycmVudCwgdGhpcy5pbmRleClcbiAgICAgICAgICAgIG1lZGlhLm1lc2gucG9zaXRpb24ueSArPSBNYXRoLmNvcygobWVkaWEubWVzaC5wb3NpdGlvbi54IC8gdGhpcy5zaXplcy53aWR0aCkgKiBNYXRoLlBJICogMC4xKSAqIDQwIC0gNDBcbiAgICAgICAgXG4gICAgICAgIH0pXG4gICAgICAgIFxuICAgICAgICAvLyDkvKDnu5ltZWRpYeaWh+S7tizlsIblvZPliY3nmoTpvKDmoIfmu5rliqjkvY3nva7kvKDnu5ltZWRpYVxuXG4gICAgICAgXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVzdHJveVxuICAgICAqL1xuICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMuc2NlbmUucmVtb3ZlQ2hpbGQodGhpcy5ncm91cClcbiAgICB9XG5cbn0iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmggPSAoKSA9PiAoXCIxYWE2MWZmZTk4NDFlODEyM2IzMlwiKSJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsImdsIiwic2NlbmUiLCJzaXplcyIsInRyYW5zaXRpb24iLCJ0aGlzIiwiaWQiLCJ0cmFuc2Zvcm1QcmVmaXgiLCJQcmVmaXgiLCJncm91cCIsIlRyYW5zZm9ybSIsImdhbGxlcnlFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZ2FsbGVyeVdyYXBwZXJFbGVtZW50IiwidGl0bGVzRWxlbWVudCIsImNvbGxlY3Rpb25zRWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY29sbGVjdGlvbnNFbGVtZW50c0FjdGl2ZSIsIm1lZGlhc0VsZW1lbnRzIiwic2Nyb2xsIiwiY3VycmVudCIsInRhcmdldCIsImxlcnAiLCJsYXN0IiwidmVsb2NpdHkiLCJjcmVhdGVHZW9tZXRyeSIsImNyZWF0ZUdhbGxlcnkiLCJvblJlc2l6ZSIsInNldFBhcmVudCIsInNob3ciLCJnZW9tZXRyeSIsIlBsYW5lIiwibWVkaWFzIiwibWFwIiwiZWxlbWVudCIsImluZGV4IiwiTWVkaWEiLCJhbmltYXRlIiwibWVzaCIsIl8iLCJtZWRpYSIsImhpZGUiLCJldmVudCIsImJvdW5kcyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImxpbWl0Iiwid2lkdGgiLCJjbGllbnRXaWR0aCIsIm9uVG91Y2hEb3duIiwieCIsInkiLCJvblRvdWNoTW92ZSIsImRpc3RhbmNlIiwic3RhcnQiLCJlbmQiLCJvblRvdWNoVXAiLCJvbldoZWVsIiwicGl4ZWxZIiwib25DaGFuZ2UiLCJzZWxlY3RlZENvbGxlY3Rpb24iLCJwYXJzZUludCIsImdldEF0dHJpYnV0ZSIsImVsZW1lbnRJbmRleCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInN0eWxlIiwidXBkYXRlIiwiR1NBUCIsInV0aWxzIiwiY2xhbXAiLCJpbnRlcnBvbGF0ZSIsImRpcmVjdGlvbiIsIk1hdGgiLCJmbG9vciIsImFicyIsImxlbmd0aCIsInBvc2l0aW9uIiwiY29zIiwiUEkiLCJkZXN0cm95IiwicmVtb3ZlQ2hpbGQiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiaCJdLCJzb3VyY2VSb290IjoiIn0=