/*! For license information please see main.96ef1b4548b8e02800d3.hot-update.js.LICENSE.txt */
self.webpackHotUpdatefloema("main",{"./app/components/Canvas/collections/index.js":(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var l=t("./node_modules/ogl/src/core/Transform.js"),o=t("./node_modules/ogl/src/extras/Plane.js"),r=t("./node_modules/gsap/index.js"),a=t("./node_modules/prefix/index.js"),i=t.n(a),n=t("./node_modules/lodash/map.js"),c=t.n(n),d=t("./app/components/Canvas/collections/Media.js");t("node:test");const u=class{constructor({gl:e,scene:s,sizes:t,transition:o}){this.transition=o,this.id="collections",this.gl=e,this.scene=s,this.sizes=t,this.transformPrefix=i()("transform"),this.group=new l.Transform,this.galleryElement=document.querySelector(".collections__gallery"),this.galleryWrapperElement=document.querySelector(".collections__gallery__wrapper"),this.titlesElement=document.querySelector(".collections__titles"),this.collectionsElements=document.querySelectorAll(".collections__article"),this.collectionsElementsActive="collections__article--active",this.mediasElements=document.querySelectorAll(".collections__gallery__media"),this.scroll={current:0,target:0,lerp:.1},this.scroll={current:0,target:0,last:0,lerp:.1,velocity:1},this.createGeometry(),this.createGallery(),this.onResize({sizes:this.sizes}),this.group.setParent(this.scene),this.show()}createGeometry(){this.geometry=new o.Plane(this.gl)}createGallery(){this.medias=c()(this.mediasElements,((e,s)=>new d.default({element:e,geometry:this.geometry,gl:this.gl,index:s,scene:this.group,sizes:this.sizes})))}async show(){if(this.transition){const{src:e}=this.transition.mesh.program.uniforms.tMap.value.image,s=window.TEXTURES[e],t=this.medias.find((e=>e.texture===s)),l=-t.bounds.left-t.bounds.width/2+window.innerWidth/2;this.update(),this.transition.animate({position:{x:0,y:0,z:0},rotation:t.mesh.rotation,scale:t.mesh.scale},(e=>{t.opacity.multiplier=1,c()(this.medias,(e=>{t!==e&&e.show()})),this.scroll.current=this.scroll.target=this.scroll.start=this.scroll.last=l}))}else c()(this.medias,(e=>e.show()))}hide(){c()(this.medias,(e=>e.hide()))}onResize(e){this.sizes=e.sizes,this.bounds=this.galleryWrapperElement.getBoundingClientRect(),this.scroll.last=this.scroll.target=0,c()(this.medias,(s=>s.onResize(e,this.scroll))),this.scroll.limit=this.bounds.width-this.medias[0].element.clientWidth}onTouchDown({x:e,y:s}){this.scroll.last=this.scroll.current}onTouchMove({x:e,y:s}){const t=e.start-e.end;this.scroll.target=this.scroll.last-t}onTouchUp({x:e,y:s}){}onWheel({pixelY:e}){this.scroll.target+=e}onChange(e){this.index=e;const s=parseInt(this.mediasElements[this.index].getAttribute("data-index"));c()(this.collectionsElements,((e,t)=>{t===s?e.classList.add(this.collectionsElementsActive):e.classList.remove(this.collectionsElementsActive)})),this.titlesElement.style[this.transformPrefix]=`translateY(-${25*s}%) translate(-50%, -50%) rotate(-90deg)`}update(){this.scroll.target=r.default.utils.clamp(-this.scroll.limit,0,this.scroll.target),this.scroll.current=r.default.utils.interpolate(this.scroll.current,this.scroll.target,this.scroll.lerp),this.galleryElement.style[this.transformPrefix]=`translateX(${this.scroll.current}px)`,this.scroll.last<this.scroll.current?this.scroll.direction="right":this.scroll.last>this.scroll.current&&(this.scroll.direction="left"),this.scroll.last=this.scroll.current;const e=Math.floor(Math.abs((this.scroll.current-this.medias[0].bounds.width/2)/this.scroll.limit)*(this.medias.length-1));this.index!==e&&this.onChange(e),c()(this.medias,((e,s)=>{e.update(this.scroll.current,this.index)}))}destroy(){this.scene.removeChild(this.group)}}},"node:test":()=>{throw new Error('Module build failed: UnhandledSchemeError: Reading from "node:test" is not handled by plugins (Unhandled scheme).\nWebpack supports "data:" and "file:" URIs by default.\nYou may need an additional plugin to handle "node:" URIs.\n    at /Users/auravar/Projects/floema/node_modules/webpack/lib/NormalModule.js:838:25\n    at Hook.eval [as callAsync] (eval at create (/Users/auravar/Projects/floema/node_modules/tapable/lib/HookCodeFactory.js:33:10), <anonymous>:6:1)\n    at Hook.CALL_ASYNC_DELEGATE [as _callAsync] (/Users/auravar/Projects/floema/node_modules/tapable/lib/Hook.js:18:14)\n    at Object.processResource (/Users/auravar/Projects/floema/node_modules/webpack/lib/NormalModule.js:835:8)\n    at processResource (/Users/auravar/Projects/floema/node_modules/loader-runner/lib/LoaderRunner.js:220:11)\n    at iteratePitchingLoaders (/Users/auravar/Projects/floema/node_modules/loader-runner/lib/LoaderRunner.js:171:10)\n    at runLoaders (/Users/auravar/Projects/floema/node_modules/loader-runner/lib/LoaderRunner.js:398:2)\n    at NormalModule._doBuild (/Users/auravar/Projects/floema/node_modules/webpack/lib/NormalModule.js:825:3)\n    at NormalModule.build (/Users/auravar/Projects/floema/node_modules/webpack/lib/NormalModule.js:969:15)\n    at /Users/auravar/Projects/floema/node_modules/webpack/lib/Compilation.js:1377:12\n    at NormalModule.needBuild (/Users/auravar/Projects/floema/node_modules/webpack/lib/NormalModule.js:1257:32)\n    at Compilation._buildModule (/Users/auravar/Projects/floema/node_modules/webpack/lib/Compilation.js:1358:10)\n    at /Users/auravar/Projects/floema/node_modules/webpack/lib/util/AsyncQueue.js:305:10\n    at Hook.eval [as callAsync] (eval at create (/Users/auravar/Projects/floema/node_modules/tapable/lib/HookCodeFactory.js:33:10), <anonymous>:6:1)\n    at AsyncQueue._startProcessing (/Users/auravar/Projects/floema/node_modules/webpack/lib/util/AsyncQueue.js:295:26)\n    at AsyncQueue._ensureProcessing (/Users/auravar/Projects/floema/node_modules/webpack/lib/util/AsyncQueue.js:282:12)\n    at processImmediate (node:internal/timers:466:21)')}},(function(e){e.h=()=>"df364c62ec778e590921"}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGVBQWU0RSxNQUFNbEYsS0FBS0UsaUJBQW9CLGNBQWFGLEtBQUtlLE9BQU9DLGFBR3hFaEIsS0FBS2UsT0FBT0ksS0FBT25CLEtBQUtlLE9BQU9DLFFBQ2pDaEIsS0FBS2UsT0FBT3dFLFVBQVksUUFDZnZGLEtBQUtlLE9BQU9JLEtBQU9uQixLQUFLZSxPQUFPQyxVQUN4Q2hCLEtBQUtlLE9BQU93RSxVQUFZLFFBSTFCdkYsS0FBS2UsT0FBT0ksS0FBT25CLEtBQUtlLE9BQU9DLFFBRS9CLE1BQU1lLEVBQVF5RCxLQUFLQyxNQUFNRCxLQUFLRSxLQUFLMUYsS0FBS2UsT0FBT0MsUUFBVWhCLEtBQUs0QixPQUFPLEdBQUdpQixPQUFPRSxNQUFRLEdBQUsvQyxLQUFLZSxPQUFPa0QsUUFBVWpFLEtBQUs0QixPQUFPK0QsT0FBUyxJQUduSTNGLEtBQUsrQixRQUFVQSxHQUNqQi9CLEtBQUswRSxTQUFTM0MsR0FHaEJGLElBQUk3QixLQUFLNEIsUUFBUSxDQUFDZSxFQUFPWixLQUN2QlksRUFBTU0sT0FBT2pELEtBQUtlLE9BQU9DLFFBQVNoQixLQUFLK0IsTUFBTSxHQVFqRCxDQUtBNkQsT0FBQUEsR0FDRTVGLEtBQUtILE1BQU1nRyxZQUFZN0YsS0FBS0ksTUFDOUIsMG1FQ3RORjBGLEVBQW9CQyxFQUFJLElBQU0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mbG9lbWEvLi9hcHAvY29tcG9uZW50cy9DYW52YXMvY29sbGVjdGlvbnMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vZmxvZW1hL3dlYnBhY2svcnVudGltZS9nZXRGdWxsSGFzaCJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7IFBsYW5lLCBUcmFuc2Zvcm0gfSBmcm9tICdvZ2wnO1xuaW1wb3J0IEdTQVAgZnJvbSAnZ3NhcCdcbmltcG9ydCBQcmVmaXggZnJvbSAncHJlZml4J1xuXG5pbXBvcnQgbWFwIGZyb20gJ2xvZGFzaC9tYXAnXG5cbmltcG9ydCBNZWRpYSBmcm9tICcuL01lZGlhJ1xuaW1wb3J0IHsgaXQgfSBmcm9tICdub2RlOnRlc3QnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHsgZ2wsIHNjZW5lLCBzaXplcywgdHJhbnNpdGlvbiB9KSB7XG4gICAgdGhpcy50cmFuc2l0aW9uID0gdHJhbnNpdGlvbjtcbiAgICB0aGlzLmlkID0gJ2NvbGxlY3Rpb25zJztcbiAgICB0aGlzLmdsID0gZ2w7XG4gICAgdGhpcy5zY2VuZSA9IHNjZW5lXG4gICAgdGhpcy5zaXplcyA9IHNpemVzO1xuXG4gICAgdGhpcy50cmFuc2Zvcm1QcmVmaXggPSBQcmVmaXgoJ3RyYW5zZm9ybScpXG4gICAgdGhpcy5ncm91cCA9IG5ldyBUcmFuc2Zvcm0oKTtcblxuICAgIHRoaXMuZ2FsbGVyeUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29sbGVjdGlvbnNfX2dhbGxlcnknKVxuICAgIHRoaXMuZ2FsbGVyeVdyYXBwZXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbGxlY3Rpb25zX19nYWxsZXJ5X193cmFwcGVyJylcblxuICAgIHRoaXMudGl0bGVzRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb2xsZWN0aW9uc19fdGl0bGVzJylcblxuICAgIHRoaXMuY29sbGVjdGlvbnNFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb2xsZWN0aW9uc19fYXJ0aWNsZScpXG4gICAgdGhpcy5jb2xsZWN0aW9uc0VsZW1lbnRzQWN0aXZlID0gJ2NvbGxlY3Rpb25zX19hcnRpY2xlLS1hY3RpdmUnXG5cbiAgICB0aGlzLm1lZGlhc0VsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcbiAgICAgICcuY29sbGVjdGlvbnNfX2dhbGxlcnlfX21lZGlhJ1xuICAgICk7XG5cbiAgICB0aGlzLnNjcm9sbCA9IHtcbiAgICAgIGN1cnJlbnQ6IDAsXG4gICAgICB0YXJnZXQ6IDAsXG4gICAgICBsZXJwOiAwLjFcbiAgICB9XG5cblxuICAgIHRoaXMuc2Nyb2xsID0ge1xuICAgICAgY3VycmVudDogMCxcbiAgICAgIHRhcmdldDogMCxcbiAgICAgIGxhc3Q6IDAsXG4gICAgICBsZXJwOiAwLjEsXG4gICAgICB2ZWxvY2l0eTogMVxuICAgIH1cblxuICAgIHRoaXMuY3JlYXRlR2VvbWV0cnkoKTtcbiAgICB0aGlzLmNyZWF0ZUdhbGxlcnkoKTtcblxuICAgIHRoaXMub25SZXNpemUoeyBzaXplczogdGhpcy5zaXplcyB9KTtcblxuICAgIHRoaXMuZ3JvdXAuc2V0UGFyZW50KHRoaXMuc2NlbmUpO1xuXG4gICAgdGhpcy5zaG93KClcbiAgICAvLyDlp5DvvIxjb25zdHJ1Y3RvcuagvOW8j+aYryh7fSl7feOAguS4jeimgeW/mOiusOS6hlxuXG4gIH1cblxuICBjcmVhdGVHZW9tZXRyeSgpIHtcbiAgICB0aGlzLmdlb21ldHJ5ID0gbmV3IFBsYW5lKHRoaXMuZ2wpXG4gIH1cblxuICBjcmVhdGVHYWxsZXJ5KCkge1xuICAgIC8vIOS8oOWIsE1lZGlh6YeM6Z2iXG4gICAgdGhpcy5tZWRpYXMgPSBtYXAodGhpcy5tZWRpYXNFbGVtZW50cywgKGVsZW1lbnQsIGluZGV4KSA9PiB7XG4gICAgICByZXR1cm4gbmV3IE1lZGlhKHtcbiAgICAgICAgZWxlbWVudCxcbiAgICAgICAgZ2VvbWV0cnk6IHRoaXMuZ2VvbWV0cnksXG4gICAgICAgIGdsOiB0aGlzLmdsLFxuICAgICAgICBpbmRleCxcbiAgICAgICAgc2NlbmU6IHRoaXMuZ3JvdXAsXG4gICAgICAgIHNpemVzOiB0aGlzLnNpemVzXG4gICAgICB9KTtcbiAgICB9KVxuICB9XG5cbiAgLy8gQW5pbWF0aW9uc1xuICBhc3luYyBzaG93KCkge1xuICAgIGlmICh0aGlzLnRyYW5zaXRpb24pIHtcbiAgICAgIGNvbnN0IHsgc3JjIH0gPSB0aGlzLnRyYW5zaXRpb24ubWVzaC5wcm9ncmFtLnVuaWZvcm1zLnRNYXAudmFsdWUuaW1hZ2U7XG4gICAgICBjb25zdCB0ZXh0dXJlID0gd2luZG93LlRFWFRVUkVTW3NyY107XG4gICAgICBjb25zdCBtZWRpYSA9IHRoaXMubWVkaWFzLmZpbmQoKG1lZGlhKSA9PiBtZWRpYS50ZXh0dXJlID09PSB0ZXh0dXJlKTtcbiAgICAgIGNvbnN0IHNjcm9sbCA9IC1tZWRpYS5ib3VuZHMubGVmdCAtIG1lZGlhLmJvdW5kcy53aWR0aCAvIDIgKyB3aW5kb3cuaW5uZXJXaWR0aCAvIDI7XG5cbiAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgIFxuICAgICAgdGhpcy50cmFuc2l0aW9uLmFuaW1hdGUoe1xuICAgICAgICBwb3NpdGlvbjogeyB4OiAwLCB5OiAwLCB6OiAwIH0sXG4gICAgICAgIHJvdGF0aW9uOiBtZWRpYS5tZXNoLnJvdGF0aW9uLFxuICAgICAgICBzY2FsZTogbWVkaWEubWVzaC5zY2FsZSxcbiAgICAgICAgLy8g6K6p6L+U5Zue55qE5Zu+54mHbWF0aOWOn+adpeeahOS9jee9rlxuXG4gICAgICB9LCBfID0+IHtcbiAgICAgICAgbWVkaWEub3BhY2l0eS5tdWx0aXBsaWVyID0gMTtcblxuICAgICAgICBtYXAodGhpcy5tZWRpYXMsIGl0ZW0gPT4ge1xuICAgICAgICAgIGlmIChtZWRpYSAhPT0gaXRlbSkge1xuICAgICAgICAgICAgaXRlbS5zaG93KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICBcbiAgICAgICAgdGhpcy5zY3JvbGwuY3VycmVudCA9IHRoaXMuc2Nyb2xsLnRhcmdldCA9IHRoaXMuc2Nyb2xsLnN0YXJ0ID0gdGhpcy5zY3JvbGwubGFzdCA9IHNjcm9sbDtcbiAgICAgIFxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgbWFwKHRoaXMubWVkaWFzLCBtZWRpYSA9PiBtZWRpYS5zaG93KCkpXG4gICAgfVxuICB9XG4gIGhpZGUoKSB7XG4gICAgbWFwKHRoaXMubWVkaWFzLCAobWVkaWEpID0+IG1lZGlhLmhpZGUoKSlcbiAgfVxuXG4gIC8vIEV2ZW50c1xuICBvblJlc2l6ZShldmVudCkge1xuICAgIHRoaXMuc2l6ZXMgPSBldmVudC5zaXplc1xuICAgIC8vIOWxj+W5leeahOWwuuWvuO+8jOe7mXVwZGF0ZeiAjOS4jeaYr+eUu+W4g+eahFxuICAgIHRoaXMuYm91bmRzID0gdGhpcy5nYWxsZXJ5V3JhcHBlckVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAvLyDojrflj5blhYPntKDnmoTkvY3nva7lkozlsLrlr7hcblxuICAgIC8vIOiuoeeul+W9k+WJjeeUu+W7iueahOWuveW6puWNoOinhueql+WPo+eahOWuveW6pueahOWkmuWwkeeEtuWQjuS5mOS7peWFt+S9k+eahOWuveW6pi0tPuWwhuWFg+e0oOWcqOinhuWPo+S4reeahOavlOS+i+i9rOaNouS4uuWFt+S9k+eahOWunumZheWuveW6puOAguWTjeW6lOW8j+W4g+WxgFxuICAgIHRoaXMuc2Nyb2xsLmxhc3QgPSB0aGlzLnNjcm9sbC50YXJnZXQgPSAwXG5cbiAgICBtYXAodGhpcy5tZWRpYXMsIG1lZGlhID0+IG1lZGlhLm9uUmVzaXplKGV2ZW50LCB0aGlzLnNjcm9sbCkpXG4gICAgdGhpcy5zY3JvbGwubGltaXQgPSB0aGlzLmJvdW5kcy53aWR0aCAtIHRoaXMubWVkaWFzWzBdLmVsZW1lbnQuY2xpZW50V2lkdGhcblxuICB9XG5cbiAgb25Ub3VjaERvd24oeyB4LCB5IH0pIHtcbiAgICB0aGlzLnNjcm9sbC5sYXN0ID0gdGhpcy5zY3JvbGwuY3VycmVudFxuICB9XG5cbiAgb25Ub3VjaE1vdmUoeyB4LCB5IH0pIHtcbiAgICBjb25zdCBkaXN0YW5jZSA9IHguc3RhcnQgLSB4LmVuZFxuXG4gICAgdGhpcy5zY3JvbGwudGFyZ2V0ID0gdGhpcy5zY3JvbGwubGFzdCAtIGRpc3RhbmNlXG4gICAgLy8g5aaC5p6c6byg5qCH5ZKM5Zu+54mH55qE56e75Yqo55u45Y+N5pa55ZCR77yM6KaB55So5YeP5Y+3XG4gICAgLy8gY29uc29sZS5sb2codGhpcy5zY3JvbGwudGFyZ2V0LCBkaXN0YW5jZSlcbiAgICAvLyDlpoLmnpzlm77niYfkuI3og73np7vliqjvvIznnIvkuIvpvKDmoIfog73kuI3og73np7vliqjmlbDmja7vvIzlpoLmnpzpvKDmoIfog73np7vliqjmlbDmja7vvIzpgqPlsLHmmK/msqHmnInmiorov5nkuKrlgLznu5nliLBtZWRpYeiuqeWbvueJh+enu+WKqFxuICB9XG5cbiAgb25Ub3VjaFVwKHsgeCwgeSB9KSB7XG5cbiAgfVxuXG4gIG9uV2hlZWwoeyBwaXhlbFkgfSkge1xuICAgIC8vIOaNleiOt+a7muWKqOS6i+S7tueahOWDj+e0oOWAvO+8jOeEtuWQjuagueaNrui/meS6m+WAvOadpeabtOaWsOmhtemdouS4reafkOS6m+WFg+e0oOeahOS9jee9ruaIlueKtuaAge+8jOWunueOsOmhtemdoueahOa7muWKqOaIluinhuWbvueahOWPmOWMllxuICAgIHRoaXMuc2Nyb2xsLnRhcmdldCArPSBwaXhlbFlcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGFuZ2Vk6IGU5Yqo5Yqo55S75Zu+54mH5paH5a2X5qCH6aKYXG4gICAqL1xuICBvbkNoYW5nZShpbmRleCkge1xuICAgIC8vIOS7juWFtuS7luWcsOaWueaOpeWPl+e0ouW8lSzpvKDmoIfmu5HliqjvvIzlt6bkuIvop5LmloflrZflhoXlrrnot5/nnYDlm77niYflj5jljJZcbiAgICB0aGlzLmluZGV4ID0gaW5kZXhcblxuICAgIGNvbnN0IHNlbGVjdGVkQ29sbGVjdGlvbiA9IHBhcnNlSW50KHRoaXMubWVkaWFzRWxlbWVudHNbdGhpcy5pbmRleF0uZ2V0QXR0cmlidXRlKCdkYXRhLWluZGV4JykpXG5cbiAgICBtYXAodGhpcy5jb2xsZWN0aW9uc0VsZW1lbnRzLCAoZWxlbWVudCwgZWxlbWVudEluZGV4KSA9PiB7XG4gICAgICBpZiAoZWxlbWVudEluZGV4ID09PSBzZWxlY3RlZENvbGxlY3Rpb24pIHtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuY29sbGVjdGlvbnNFbGVtZW50c0FjdGl2ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmNvbGxlY3Rpb25zRWxlbWVudHNBY3RpdmUpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMudGl0bGVzRWxlbWVudC5zdHlsZVt0aGlzLnRyYW5zZm9ybVByZWZpeF0gPSBgdHJhbnNsYXRlWSgtJHsyNSAqIHNlbGVjdGVkQ29sbGVjdGlvbn0lKSB0cmFuc2xhdGUoLTUwJSwgLTUwJSkgcm90YXRlKC05MGRlZylgXG5cbiAgfVxuXG4gIC8vIFVwZGF0ZVxuICB1cGRhdGUoKSB7XG4gICAgdGhpcy5zY3JvbGwudGFyZ2V0ID0gR1NBUC51dGlscy5jbGFtcCgtdGhpcy5zY3JvbGwubGltaXQsIDAsIHRoaXMuc2Nyb2xsLnRhcmdldClcbiAgICAvLyDmu5rliqjmu5rova7pmZDliLZcblxuICAgIHRoaXMuc2Nyb2xsLmN1cnJlbnQgPSBHU0FQLnV0aWxzLmludGVycG9sYXRlKHRoaXMuc2Nyb2xsLmN1cnJlbnQsIHRoaXMuc2Nyb2xsLnRhcmdldCwgdGhpcy5zY3JvbGwubGVycClcblxuICAgIHRoaXMuZ2FsbGVyeUVsZW1lbnQuc3R5bGVbdGhpcy50cmFuc2Zvcm1QcmVmaXhdID0gYHRyYW5zbGF0ZVgoJHt0aGlzLnNjcm9sbC5jdXJyZW50fXB4KWBcbiAgICAvLyDlsIblm77niYfpk77mjqXnmoTlrrnlmahtYXRjaOa7muWKqOeahOWdkOagh+maj+edgOWbvueJh+S4gOi1t+a7muiAjOS4jeaYr+WBnOWcqOWOn+WcsFxuXG4gICAgaWYgKHRoaXMuc2Nyb2xsLmxhc3QgPCB0aGlzLnNjcm9sbC5jdXJyZW50KSB7XG4gICAgICB0aGlzLnNjcm9sbC5kaXJlY3Rpb24gPSAncmlnaHQnXG4gICAgfSBlbHNlIGlmICh0aGlzLnNjcm9sbC5sYXN0ID4gdGhpcy5zY3JvbGwuY3VycmVudCkge1xuICAgICAgdGhpcy5zY3JvbGwuZGlyZWN0aW9uID0gJ2xlZnQnXG4gICAgfVxuICAgIC8vIOajgOa1i+m8oOagh+a7muWKqOaWueWQke+8jOW9k+WJjeS9jee9ruWSjOWFiOWJjeS9jee9ruWBmuavlOi+g+OAglxuXG4gICAgdGhpcy5zY3JvbGwubGFzdCA9IHRoaXMuc2Nyb2xsLmN1cnJlbnRcblxuICAgIGNvbnN0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLmFicygodGhpcy5zY3JvbGwuY3VycmVudCAtIHRoaXMubWVkaWFzWzBdLmJvdW5kcy53aWR0aCAvIDIpIC8gdGhpcy5zY3JvbGwubGltaXQpICogKHRoaXMubWVkaWFzLmxlbmd0aCAtIDEpKTtcbiAgICAvL+WHj+WOu+S4gOWNiueahOWNoeeJh+WuveW6pizkvb/lvpfmj5DliY1oaWdobGlnaHTljaHniYcs6ICM5LiN5piv562J5Yiw5Y2h54mHeei9tOS4reW/g+aJjea/gOa0u+WwseaFouS6hlxuICAgIC8vIE1hdGguZmxvb3Is5Y+W5pW05pWw77yM5rua5Yqo54m55a6a6Led56a75ZCO56Gu5a6a5Zu+54mH5YWD57Sg5Zyo5pWw57uE5Lit55qE57Si5byVXG4gICAgaWYgKHRoaXMuaW5kZXggIT09IGluZGV4KSB7XG4gICAgICB0aGlzLm9uQ2hhbmdlKGluZGV4KVxuICAgIH1cblxuICAgIG1hcCh0aGlzLm1lZGlhcywgKG1lZGlhLCBpbmRleCkgPT4ge1xuICAgICAgbWVkaWEudXBkYXRlKHRoaXMuc2Nyb2xsLmN1cnJlbnQsIHRoaXMuaW5kZXgpXG4gICAgICAvLyBtZWRpYS5tZXNoLnBvc2l0aW9uLnkgKz0gTWF0aC5jb3MoKG1lZGlhLm1lc2gucG9zaXRpb24ueCAvIHRoaXMuc2l6ZXMud2lkdGgpICogTWF0aC5QSSAqIDAuMSkgKiA0MCAtIDQwXG5cbiAgICB9KVxuXG4gICAgLy8g5Lyg57uZbWVkaWHmlofku7Ys5bCG5b2T5YmN55qE6byg5qCH5rua5Yqo5L2N572u5Lyg57uZbWVkaWFcblxuXG4gIH1cblxuICAvKipcbiAgICogRGVzdHJveVxuICAgKi9cbiAgZGVzdHJveSgpIHtcbiAgICB0aGlzLnNjZW5lLnJlbW92ZUNoaWxkKHRoaXMuZ3JvdXApXG4gIH1cblxufSIsIl9fd2VicGFja19yZXF1aXJlX18uaCA9ICgpID0+IChcImRmMzY0YzYyZWM3NzhlNTkwOTIxXCIpIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwiZ2wiLCJzY2VuZSIsInNpemVzIiwidHJhbnNpdGlvbiIsInRoaXMiLCJpZCIsInRyYW5zZm9ybVByZWZpeCIsIlByZWZpeCIsImdyb3VwIiwiVHJhbnNmb3JtIiwiZ2FsbGVyeUVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJnYWxsZXJ5V3JhcHBlckVsZW1lbnQiLCJ0aXRsZXNFbGVtZW50IiwiY29sbGVjdGlvbnNFbGVtZW50cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjb2xsZWN0aW9uc0VsZW1lbnRzQWN0aXZlIiwibWVkaWFzRWxlbWVudHMiLCJzY3JvbGwiLCJjdXJyZW50IiwidGFyZ2V0IiwibGVycCIsImxhc3QiLCJ2ZWxvY2l0eSIsImNyZWF0ZUdlb21ldHJ5IiwiY3JlYXRlR2FsbGVyeSIsIm9uUmVzaXplIiwic2V0UGFyZW50Iiwic2hvdyIsImdlb21ldHJ5IiwiUGxhbmUiLCJtZWRpYXMiLCJtYXAiLCJlbGVtZW50IiwiaW5kZXgiLCJNZWRpYSIsInNyYyIsIm1lc2giLCJwcm9ncmFtIiwidW5pZm9ybXMiLCJ0TWFwIiwidmFsdWUiLCJpbWFnZSIsInRleHR1cmUiLCJ3aW5kb3ciLCJURVhUVVJFUyIsIm1lZGlhIiwiZmluZCIsImJvdW5kcyIsImxlZnQiLCJ3aWR0aCIsImlubmVyV2lkdGgiLCJ1cGRhdGUiLCJhbmltYXRlIiwicG9zaXRpb24iLCJ4IiwieSIsInoiLCJyb3RhdGlvbiIsInNjYWxlIiwiXyIsIm9wYWNpdHkiLCJtdWx0aXBsaWVyIiwiaXRlbSIsInN0YXJ0IiwiaGlkZSIsImV2ZW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwibGltaXQiLCJjbGllbnRXaWR0aCIsIm9uVG91Y2hEb3duIiwib25Ub3VjaE1vdmUiLCJkaXN0YW5jZSIsImVuZCIsIm9uVG91Y2hVcCIsIm9uV2hlZWwiLCJwaXhlbFkiLCJvbkNoYW5nZSIsInNlbGVjdGVkQ29sbGVjdGlvbiIsInBhcnNlSW50IiwiZ2V0QXR0cmlidXRlIiwiZWxlbWVudEluZGV4IiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwic3R5bGUiLCJHU0FQIiwidXRpbHMiLCJjbGFtcCIsImludGVycG9sYXRlIiwiZGlyZWN0aW9uIiwiTWF0aCIsImZsb29yIiwiYWJzIiwibGVuZ3RoIiwiZGVzdHJveSIsInJlbW92ZUNoaWxkIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsImgiXSwic291cmNlUm9vdCI6IiJ9